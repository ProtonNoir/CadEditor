<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">

    <title>Описание модулей CadEditor</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Описание модулей CadEditor</h1>
        <h2>Список основных и специальных модулей</h2>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
      
<h2><a id="arch" class="anchor" href="#arch" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Архитектура редактора</h2>

<p>
<b>CadEditor</b> - редактор уровней для множества игр под разные платформы (NES, Sega Mega Drive, GBA).
</p>

<p>
Полный список поддерживаемых игр здесь:<br>
<a href="https://github.com/spiiin/CadEditor/blob/master/CadEditor/cad_editor_supported_games.txt">https://github.com/spiiin/CadEditor/blob/master/CadEditor/cad_editor_supported_games.txt</a></p>
</p>

<p>
Многие игры из списка (пока что) поддерживаются лишь частично – доступно редактирование определённых уровней или же возможно редактирование только определенного аспекта игры (фоны, блоки, списки врагов).
Это не полноценная справка, а только краткое описание модулей программы. </p>

<p>
Редактор состоит из нескольких стандартных модулей (редакторы элементов которые встречаются во всех играх - игровые экраны, блоки разных уровней, списки объектов), а также плагинов, которые подключаются для конкретных игр (например плагин-редактор игровой карты для игр Capcom или плагин-редактор формы уровня). Плагины оформлены в виде отдельных .Net-сборок, которые подгружаются основным редактором во время начала работы над редактированием игры.</p>

<p>Настройки для открытия конкретной игры хранятся в виде текстового файла на языке C# (конфига игры). В нём указаны адреса, по которым редактор считывает и записывает данные об уровне из ROM-файла или дампа памяти, а также способы загрузки игровых данных (они могут быть описаны на языке C# или вызывать готовые функции из библиотеки самого редактора).</p>

<p>
В настоящий момент в комплекте с редактором идут более 400 конфигов, позволяющих редактировать около 500 разных уровней в более чем 80 играх для платформ NES и SMD.</p>

<h2><a id="osn" class="anchor" href="#osn" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Основные модули редактора</h2>
<h3>Screen Editor (Редактор экранов).</h3>
<p>
<img src="images/tut1_cad_editor_main.png" alt="редактор экранов">
Главное окно программы. Из него можно открывать остальные редакторы, а также изменять игровые экраны. Для некоторых игр один игровой экран соотвествует целому уровню, для других уровень строится из нескольких экранов одинаковой (реже разной) формы. Игровые экраны состоят из блоков, которые включают в себе один или несколько тайлов видеопамяти (а также информацию и палитре и физике, которая специфична для конкретной игры и платформы). Чаще всего встречаются блоки размеров 2x2 или 4x4 тайла, но бывают и другие варианты.
</p>

<p>
Редактор позволяет использовать блоки, которые построены по информации взятой из ROM (необходимо задать соотвествующие функции для чтения и записи блоков в конфиге), либо же взять их заранее подготовленного изображения (в этом случае в конфиге необходимо указать имя файла с изображением и размер одного блока на нём. Редактор трактует изображение как ленту с набором последовательно нарисованных на ней слева-направо блоков).
</p>

<p>
Дополнительная возможность редактора экранов состоит в возможности объединения блоков в структуры (кнопка Make structures или просто выделить рамкой группу блоков на экране с зажатой кнопкой shift) - в этом случае создаётся виртуальная "кисть" из группы блоков. Она не будет сохранена в ROM, а просто позволит поставить на экране целую группу объектов (это удобно для игр с маленькими блоками и большими картами - например, можно выделить из сохранить как кисть большую группу блоков, которые составляют цельный объект, например, бочку или дерево):
</p>
<img src="images/tut1_cad_editor_structures.png" alt="редактор структур">
<br>
<h3>Block editor (Редактор блоков).</h3>
<p>
В случае, если в конфиге заданы правила чтения и записи блоков из ROM, для него можно включить редактор блоков. Тогда из программы можно будет перестроить не только экраны, но и сами блоки - в редактор блоков можно изменить тайлы видеопамяти, из которых состоит блок, цвета палитры, в которые будет окрашены эти тайла, а также для некоторых игр - физический тип блока (фон, стена, шипы, скрытый проход и т.п.).
</p>
<p>
Версия для NES-игр (поддерживает блоки любого размера):
</p>
<img src="images/tut1_cad_editor_blocks.png" alt="редактор блоков">
<p>
Версия для Sega-игр (поддерживает блоки размером 2x2 и 4x4 тайлов):
</p>
<img src="images/tut1_cad_editor_blocks_sega.png" alt="редактор блоков sega">
<br>
<h3>Big Block Editor (Редактор макроблоков).</h3>
<p>
Иногда экраны в игре строятся не из блоков, а из макроблоков - структур, которые сами состоят не из тайлов видеопамяти, а из блоков меньшего размера. В этом случае в конфиге можно указать способ построение макроблоков из блоков и включить редактор макроблоков - в нём можно поменять блоки, из которых состоит каждый конкретный макроблок.
</p>
<p>
В некоторых играх (Rokin' Cats, например), макроблоки могут сами объединяться в ещё большие макроблоки 2 уровня, и так далее. Это также может быть описано в конфиге игры и включено в редакторе макроблоков.
</p>
<img src="images/tut1_cad_editor_bigblocks2.png" alt="редактор больших больших блоков">

<p>
В некоторых играх (Tiny Toon, Ninja Cats) информация о палитре и физических свойствах тайлов может кодироваться не на уровне блоков, а на уровне макроблоков, редактор поддерживает описание и таких макроблоков с дополнительной информацией.
</p>
<img src="images/tut1_cad_editor_bigblocks.png" alt="редактор больших блоков">
<p>
(На скриншоте видны макроблоки с изображениями облаков, которые состоят из одних и тех же блоков, но используют разные цвета в палитре).
</p>

<h3>Enemy editor (Редактор объектов).</h3>
<p>
В редакторе объектов можно изменить список игровых объектов (враги, призы, двери - в зависимости от игры). Для некоторых игр разные объекты хранятся в разных списках, в конфигах можно задать несколько функций для чтения-записи этих списков, в этом случае в редакторе объектов будет доступно редактирование сразу нескольких списков. В самом общем случае объект представлен его номером и координатами на экране, различные игры могут добавлять к этому самую разную дополнительную информацию (здоровье каждого конкретного врага, выпадающий из него приз и т.п.).
</p>
<img src="images/tut1_cad_editor_enemy_editor.png" alt="редактор объектов">

<p>
Для многих игровых движков также важен порядок хранения объектов в списке (например, в Chip & Dale Rescue Rangers объекты должны храниться в последовательности, в которой они будут появляться на экране, пока не появится предыдущий объект, следующий не будет прочитан), поэтому в редакторе также отображается последовательность хранения объектов в виде списка объектов в правой части окна.
</p>

<h2><a id="pod" class="anchor" href="#pod" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Подключаемые модули редактора для конкретных игр, жанров или платформ</h2>
<p>
Сюда входят модули, которые можно подключать в конфигах для определённых игр в дополнение к основным редакторам, а также библиотеки для построяния графики для определённых платформ.
</p>

<h3>PluginVideoNes.</h3>
<p>
Библиотека для построения графики в играх для платформы NES. Использует внутренние структуры CadEditor, но всесте с ним может быть использована и в других проектах.
</p>

<h3>PluginVideoSega.</h3>
<p>
Библиотека для построения графики в играх для Sega Mega Drive
</p>

<h3>PluginChrView.</h3>
<p>
Простой тайловый редактор для CHR-банков графики для игр NES.
</p>
<img src="images/tut1_cad_editor_chr_editor.png" alt="редактор тайлов">

<br>
<h3>PluginEditLayout.</h3>
<p>
Редактор раскладок (формы уровня) для некоторых игр Capcom. Позволяет записывать номера экранок в раскладку уровня, а также менять направления скроллов на этих экранах.
</p>
<img src="images/tut1_cad_editor_layout.png" alt="редактор раскладок">

<br>
<h3>PluginHexEditor.</h3>
<p>
Примитивный шестнадцатеричный редактор, который позволяет изменить любой байт в ROM-файле, однако его возможности сильно ограничены, лучше использовать сторонний более мощный hex-редактор.
</p>
<img src="images/tut1_cad_editor_hex.png" alt="hex-редактор">

<br>
<h3>PluginExportScreens.</h3>
<p>
Модуль для экспорта данных об индексах блоков на экранах. В виде картинки (для построения карты всего уровня) или бинарных данных (для использования в других проектах).
</p>
<img src="images/tut1_cad_editor_export_screens.png" alt="экспорт экранов">

<br>
<h3>PluginLevelParamsCad.</h3>
<p>
Редактор параметров уровня для Chip & Dale (номера используемых банков памяти, палитры, мелодии и т.п.)
</p>
<img src="images/tut1_cad_editor_cad_levels.png" alt="параметры уровня">

<br>
<h3>PluginMapEditor.</h3>
<p>
Редактор глобальной карты (и некоторых других игровых экранов) для игр Capcom. Поддерживает 2 типа сжатия (rle и описательное), сохраняет карту в виде отдельного сжатого файла map.bin.
</p>
<img src="images/tut1_cad_editor_map.png" alt="карта мира">

<br>
<h3>PluginAnimEditor.</h3>
<p>
Редактор всех игровых анимаций для игр Capcom.
</p>
<img src="images/tut1_cad_editor_anim.png" alt="редактор анимаций">

<br>
<h3>PluginSegaBackEditor.</h3>
<p>
Редактор экранов, описанных маппингами для SMD-игр.
</p>
<img src="images/tut1_cad_editor_back_editor.png" alt="редактор фонов sega">

  </section>
  </div> 
  </body>
</html>
